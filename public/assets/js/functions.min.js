function Ajax(t){t.addEventListener("submit",(e=>{e.preventDefault();const n=new FormData(t),o={method:t.getAttribute("method"),body:n,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}},i=Spinner.show();fetch(t.getAttribute("action"),o).then((t=>{if(Spinner.hide(i),200!==t.status)throw t;Toast.show("Saved successfully.",{class:"toast--success"})})).catch((()=>{Spinner.hide(i),Toast.show("There was an error saving your notes.",{class:"toast--error"})}))}))}function initAjax(){document.querySelectorAll("[data-ajax]").forEach((t=>{Ajax(t)}))}function Confirmable(t){t.addEventListener("click",(t=>{const e=t.target.getAttribute("data-confirmable");window.confirm(e)&&t.target.closest("form").submit()}))}function initConfirmable(){document.querySelectorAll("[data-confirmable]").forEach((t=>{Confirmable(t)}))}function debounce(t,e,n){let o;return function(){const i=this,r=arguments,a=function(){o=null,n||t.apply(i,r)},s=n&&!o;clearTimeout(o),o=setTimeout(a,e),s&&t.apply(i,r)}}function Filterable(t){const e=document.querySelectorAll("[data-filterable-input]"),n=t.querySelectorAll("[data-filterable-item]"),o=document.getElementById("no-results"),i=t=>t.toLowerCase().replace(/ & /g,"-and-").replace(/<[^>]+>/g,"").replace(/['’.]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/--+/g,"-"),r=t=>{const e=t.target,r=e.getAttribute("data-filterable-key"),a=i(e.value);n.forEach((t=>{const e=t.querySelector(`[data-key="${r}"]`);var n;!a||e&&(n=e,n.getAttribute("data-value")?n.getAttribute("data-value"):i(n.innerText)).indexOf(a)>-1?t.style.display="":t.style.display="none"})),(()=>{const t=Array.from(n).some((t=>"none"!==t.style.display));o.style.display=t?"none":""})()};e.forEach((t=>{t.addEventListener("keyup",debounce(r,100)),t.value&&r({target:t})}))}function initFilterable(){document.querySelectorAll("[data-filterable-list]").forEach((t=>{Filterable(t)}))}function Password(t){t.addEventListener("click",(e=>{const n=e.target.closest(".password-container").querySelector(".password-input");"password"===n.getAttribute("type")?(n.setAttribute("type","text"),t.innerText="Hide"):(n.setAttribute("type","password"),t.innerText="Show")}))}function initPassword(){document.querySelectorAll("[data-toggle-password]").forEach((t=>{Password(t)}))}function Slugable(t){const e=t.getAttribute("data-slug"),n=document.getElementById(e),o=e=>{var n;t.value=(n=e.target.value)?n.toLowerCase().replace(/ & /g,"-and-").replace(/<[^>]+>/g,"").replace(/['’.]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/--+/g,"-"):""};n.addEventListener("keyup",o)}function initSlugable(){document.querySelectorAll("[data-slug]").forEach((t=>{Slugable(t)}))}initAjax(),initConfirmable(),initFilterable(),initPassword(),initSlugable();class Spinner{static show(){let t=document.querySelector(".spinner");return t||(t=document.createElement("div"),t.setAttribute("class","spinner"),t.setAttribute("role","alert"),t.innerText="Loading...",document.body.appendChild(t)),t.style.display="",t}static hide(t){t.style.display="none"}}function initSticky(){const t=document.querySelector("[data-sticky]");if(!t)return;const e=()=>{t.setAttribute("data-sticky-offset-top",t.offsetTop),t.style.right=window.innerWidth-t.offsetLeft-t.scrollWidth+"px"};window.addEventListener("scroll",(()=>{const e=window.pageYOffset,n=parseInt(t.getAttribute("data-sticky-offset-top"),10)-parseInt(t.getAttribute("data-sticky-top"),10);t.style.position=e>n?"fixed":""})),window.addEventListener("resize",e),e()}function Timer(t){const e=t=>{const e=new Date(0);let n;return e.setSeconds(t/1e3),n=t<6e5?15:t<36e5?14:t<36e6?12:11,e.toISOString().substring(n).replace(/\.\d+Z$/,"")},n=t=>{const n=t-(new Date).getTime();return n<=0?"":e(n)},o=t=>{t.target.parentNode.remove()},i=()=>{const t=document.querySelectorAll(".timer--on");if(t.length<=0)return clearInterval(window.TICK_INTERVAL),window.TICK_INTERVAL=null,window.DRAG_ELEMENT=null,window.DRAG_START_X=0,window.DRAG_START_Y=0,document.removeEventListener("mousemove",c),document.removeEventListener("keydown",r),document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("touchcancel",d,!0),void document.removeEventListener("touchmove",u,{passive:!1});t.forEach((t=>{const i=t.getAttribute("data-since");if(i){const n=(t=>{const n=(new Date).getTime()-t;return n<=0?"":e(n)})(Date.parse(i));return void(t.querySelector(".timer__text").innerText=n)}const r=n(Date.parse(t.getAttribute("data-until")));if(""===r){t.classList.remove("timer--on");const e=t.querySelector(".timer__text");return e.removeEventListener("mousedown",a),e.removeEventListener("mouseup",s),e.addEventListener("click",o),e.innerText="Stop",void t.querySelector("audio").play()}t.querySelector(".timer__text").innerText=r}))},r=t=>{"Escape"===t.key&&(window.DRAG_ELEMENT=null)},a=t=>{window.DRAG_ELEMENT=t.target.closest(".timer");const e=parseFloat(window.DRAG_ELEMENT.style.left)||window.DRAG_ELEMENT.offsetLeft,n=parseFloat(window.DRAG_ELEMENT.style.top)||window.DRAG_ELEMENT.offsetTop,o=t.clientX?t.clientX:t.x,i=t.clientY?t.clientY:t.y;return window.DRAG_START_X=e?o-e:o,window.DRAG_START_Y=n?i-n:i,t.preventDefault(),!1},s=()=>{window.DRAG_ELEMENT=null},c=t=>{if(null===window.DRAG_ELEMENT)return;const e=window.DRAG_ELEMENT.querySelector(".timer__text");let n=t.clientX-window.DRAG_START_X;n=Math.max(0,n),n=Math.min(n,window.innerWidth-e.clientWidth);let o=t.clientY-window.DRAG_START_Y;o=Math.max(0,o),o=Math.min(o,window.innerHeight-e.clientHeight),window.DRAG_ELEMENT.style.left=`${n}px`,window.DRAG_ELEMENT.style.top=`${o}px`,window.DRAG_ELEMENT.style.bottom="auto",window.DRAG_ELEMENT.style.right="auto"},l=t=>{const e=t.changedTouches[0],n=document.createEvent("MouseEvent");return n.initMouseEvent({touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[t.type],!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),n},d=t=>{if("timer__text"!==t.target.className)return;t.changedTouches[0].target.dispatchEvent(l(t)),t.preventDefault()},u=t=>{null!==window.DRAG_ELEMENT&&(c(l(t)),t.preventDefault())},m=()=>{const e=new Date,l=parseInt(t.getAttribute("data-timer"),10),m=0===l;e.setSeconds(e.getSeconds()+l);const p=document.getElementById("timer-container"),E=document.createElement("div");E.setAttribute("class","timer timer--on"),m?E.setAttribute("data-since",e):E.setAttribute("data-until",e),p.appendChild(E);const w=document.createElement("button");if(w.setAttribute("class","timer__text"),w.setAttribute("type","button"),w.innerText=m?"0:00":n(e),w.addEventListener("mousedown",a),w.addEventListener("mouseup",s),E.appendChild(w),!m){const t=document.createElement("audio");t.setAttribute("loop",!0),E.appendChild(t);const e=document.createElement("source");e.setAttribute("src","/assets/sounds/magnolia-simms.mp3"),e.setAttribute("type","audio/mpeg"),t.appendChild(e)}const A=document.createElement("button");A.setAttribute("aria-label","Stop"),A.setAttribute("class","timer__stop"),A.setAttribute("type","button"),A.innerText="×",A.addEventListener("click",o),E.appendChild(A),window.TICK_INTERVAL||(window.TICK_INTERVAL=setInterval(i,500),window.DRAG_ELEMENT=null,window.DRAG_START_X=0,window.DRAG_START_Y=0,document.addEventListener("mousemove",c),document.addEventListener("keydown",r),document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("touchcancel",d,!0),document.addEventListener("touchmove",u,{passive:!1}))};t.addEventListener("click",m)}function initTimer(){const t=document.querySelectorAll("[data-timer]");if(t.length<=0)return;t.forEach((t=>{Timer(t)}));const e=document.createElement("div");e.setAttribute("id","timer-container"),document.body.appendChild(e)}initSticky(),initTimer();class Toast{static show(t,e={}){e.class=e.class||"",e.closeButtonClass=e.closeButtonText||"",e.closeButtonText=e.closeButtonText||"Close",e.duration=e.duration||3e3;let n=document.getElementById("toast-container");n||(n=document.createElement("div"),n.setAttribute("id","toast-container"),document.body.append(n));const o=`toast-${(new Date).getTime()}`,i=document.createElement("div");i.setAttribute("class",`toast ${e.class}`.trim()),i.setAttribute("id",o),i.setAttribute("role","alert"),i.style.animationDuration=`${e.duration}ms`,n.appendChild(i);const r=document.createElement("p");if(r.setAttribute("class","toast-text"),r.innerText=t,i.appendChild(r),!e.hideClose){const t=t=>{Toast.hide(t)},n=document.createElement("button");n.setAttribute("class",`toast-close ${e.closeButtonClass}`.trim()),n.setAttribute("type","button"),e.closeButtonAttributes&&Object.keys(e.closeButtonAttributes).forEach((t=>{n.setAttribute(t,e.closeButtonAttributes[t])})),n.innerText=e.closeButtonText,n.addEventListener("click",t),i.appendChild(n)}return setTimeout((()=>{i.remove()}),e.duration+1e3),i}static hide(t){t.target.closest(".toast").remove()}}function Toggleable(t){t.addEventListener("click",(t=>{const e=t.target.getAttribute("data-toggleable");document.querySelector(e).classList.toggle("show");const n=t.target.getAttribute("data-toggleable-body-class");n&&document.body.classList.toggle(n)}))}function initToggleable(){document.querySelectorAll("[data-toggleable]").forEach((t=>{Toggleable(t)}))}initToggleable();