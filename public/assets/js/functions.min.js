function Ajax(e){e.addEventListener("submit",(t=>{t.preventDefault();const n=new FormData(e),a={method:e.getAttribute("method"),body:n,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}},o=Spinner.show();fetch(e.getAttribute("action"),a).then((e=>{if(Spinner.hide(o),200!==e.status)throw e;Toast.show("Saved successfully.",{class:"toast--success"})})).catch((()=>{Spinner.hide(o),Toast.show("There was an error saving your notes.",{class:"toast--error"})}))}))}function initAjax(){document.querySelectorAll("[data-ajax]").forEach((e=>{Ajax(e)}))}function onBeforeUnload(e){return e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave the page?"}function addUnloadListener(){window.addEventListener("beforeunload",onBeforeUnload,{capture:!0})}function removeUnloadListener(){window.removeEventListener("beforeunload",onBeforeUnload,{capture:!0})}function initBeforeUnload(){const e=document.getElementById("form");if(e){e.querySelectorAll("input,select,textarea").forEach((e=>{e.addEventListener("keyup",addUnloadListener),e.addEventListener("change",addUnloadListener)})),e.addEventListener("submit",removeUnloadListener)}}function Confirmable(e){const t=t=>{Modal({message:t.target.getAttribute("data-confirmable"),buttons:[{label:"Cancel",class:"button--secondary"},{label:t.target.innerText,class:t.target.getAttribute("class"),onClick:()=>{e.closest("form").submit()}}]})};e.addEventListener("click",t,!0)}function initConfirmable(){document.querySelectorAll("[data-confirmable]").forEach((e=>{Confirmable(e)}))}function debounce(e,t,n){let a;return function(...o){const i=this,r=n&&!a;clearTimeout(a),a=setTimeout((()=>{a=null,n||e.apply(i,o)}),t),r&&e.apply(i,o)}}function Filterable(e){const t=document.querySelectorAll("[data-filterable-input]"),n=e.querySelectorAll("[data-filterable-item]"),a=document.getElementById("no-results"),o=e=>e.toLowerCase().replace(/ & /g,"-and-").replace(/<[^>]+>/g,"").replace(/['’.]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/--+/g,"-"),i=e=>{const t=e.target,i=t.getAttribute("data-filterable-key"),r=o(t.value);n.forEach((e=>{const t=e.querySelector(`[data-key="${i}"]`);var n;!r||t&&(n=t,n.getAttribute("data-value")?n.getAttribute("data-value"):o(n.innerText)).indexOf(r)>-1?e.style.display="":e.style.display="none"})),(()=>{const e=Array.from(n).some((e=>"none"!==e.style.display));a.style.display=e?"none":""})()};t.forEach((e=>{e.addEventListener("keyup",debounce(i,100)),e.value&&i({target:e})}))}function initFilterable(){document.querySelectorAll("[data-filterable-list]").forEach((e=>{Filterable(e)}))}function initMeasurement(){const e=document.querySelectorAll("[data-num][data-unit]");if(e.length<=0)return;const t=document.querySelectorAll("[data-amount]"),n=1/48,a=[{value:1,name:"1 cup"},{value:.75,name:"3/4 cups"},{value:2/3,name:"2/3 cups"},{value:.5,name:"1/2 cup"},{value:1/3,name:"1/3 cup"},{value:.25,name:"1/4 cup"},{value:.125,name:"1/8 cup"},{value:.0625,name:"1 tbsp"},{value:.03125,name:"1/2 tbsp"},{value:2*n,name:"2 tsp"},{value:n,name:"1 tsp"},{value:.015625,name:"3/4 tsp"},{value:n/2,name:"1/2 tsp"},{value:n/4,name:"1/4 tsp"},{value:n/8,name:"1/8 tsp"},{value:n/16,name:"1/16 tsp"}],o=(e,t)=>["1","1/2","1/3","1/4","1/8","1/16"].includes(t)?e:(e=>{if(["g","oz","ml","tsp","tbsp"].includes(e))return e;const t=e[e.length-1];return["h","o"].includes(t)?e.replace(/(.)$/,"$1es"):["y"].includes(t)?e.replace(/y$/,"ies"):`${e}s`})(e);function i(e,t){if(Math.abs(e)<=1e-14)return[];if(e<0||0===t.length)return null;let n=t[0];const a=n.value,o=i(e,t.slice(1));let r;if(n.name.match(/^\d+ cups?$/)){if(r=i(e-a,t),r){const e=r.filter((e=>e.name.match(/^\d+ cups?$/))).map((e=>e.value)).reduce(((e,t)=>e+t),0);e>0&&(r=r.filter((e=>!e.name.match(/^\d+ cups?$/))),n={value:e+n.value,name:`${e+n.value} cups`})}}else r=i(e-a,t.slice(1));if(null===o&&null===r)return null;if(null===o)return[n,...r];if(null===r)return o;const l=o.length,s=r.length+1;return l<s||l===s&&r.map((e=>e.name)).includes("2 tsp")?o:[n,...r]}const r=(e,t)=>{"tbsp"===t?e/=16:"tsp"===t&&(e/=48);const n=a.find((t=>Math.abs(e-t.value)<=1e-14));if(n)return n.name;const r=a.filter((t=>t.value<=e));if(r.length<=0)return"pinch";const l=i(e,r);if(l){const e=l.length;if(2===e&&l[0].name.match(/^\d+ cups?$/)&&l[1].name.includes("cup"))return`${l[0].value} ${l[1].name.replace(/ cups?$/,"")} ${o("cup",l[1].value)}`;if(e>0)return l.map((e=>e.name)).join(" + ")}return`${e.toFixed(2).replace(/(\.[^0])0$/,"$1")} ${o(t,e)}`},l=(e,t,n,a)=>{const i=`${e=e.toString()} ${o(t,e)}`;if(1===n&&t===a)return i;const l=!["oz","g","ml"].includes(t);if(1===n&&l&&!e.includes("."))return i;let s=(e=>{let t=0;if(e.includes(" ")&&(e=e.split(" "),t=parseInt(e[0],10),e=e[1]),e.includes("/")){const n=e.split("/");e=t+parseInt(n[0],10)/parseInt(n[1],10)}return parseFloat(e)})(e.toString())*n;return l?((e,t)=>{let n=e.toString();if(!n.includes("."))return`${n} ${o(t,n)}`;if(["cup","tbsp","tsp"].includes(t))return r(e,t);const a=[{value:.75,fraction:"3/4"},{value:.66667,fraction:"2/3"},{value:.5,fraction:"1/2"},{value:.33333,fraction:"1/3"},{value:.25,fraction:"1/4"},{value:.125,fraction:"1/8"},{value:.0625,fraction:"1/16"}],i=a.length;let l;const s=n.split("."),u="0"===s[0]?"":s[0],c=parseFloat(`.${parseFloat(s[1]).toFixed(5)}`);for(l=0;l<i;l+=1)if(c===a[l].value)return n=`${u} ${a[l].fraction}`.trim(),`${n} ${o(t,n)}`;return`${n} ${o(t,n)}`})(s,t):("oz"===t&&"g"===a?(u=s,s=Math.round(28.34952*u),t=a):"g"===t&&"oz"===a&&(s=(e=>parseFloat((e/28.34952).toFixed(1)))(s),t=a),`${s} ${o(t,e.toString())}`);var u},s=({multiplier:n,units:a})=>{if(!n){const e=document.querySelector("[data-multiplier][disabled]");e&&(n=e.getAttribute("data-multiplier"))}if(!a){const e=document.querySelector("[data-units][disabled]");e&&(a=e.getAttribute("data-units"))}e.forEach((e=>{e.innerText=l(e.getAttribute("data-num"),e.getAttribute("data-unit"),n,a)})),t.forEach((e=>{e.innerText=parseFloat(e.getAttribute("data-amount"))*n}))},u=(e,t)=>{document.querySelector(`[${t}][disabled]`).removeAttribute("disabled"),e.setAttribute("disabled",!0),e.nextSibling?e.nextSibling.focus():e.previousSibling.focus()},c=document.createElement("fieldset");document.getElementById("recipe-header").appendChild(c);let d;if([{label:"1/2",value:.5,disabled:!1},{label:"1x",value:1,disabled:!0},{label:"2x",value:2,disabled:!1}].forEach((e=>{const t=document.createElement("button");t.setAttribute("data-multiplier",e.value),e.disabled&&t.setAttribute("disabled",!0),t.setAttribute("class","button--secondary"),t.setAttribute("type","button"),t.innerText=e.label,t.addEventListener("click",(e=>{u(e.target,"data-multiplier"),s({multiplier:e.target.getAttribute("data-multiplier")})})),c.appendChild(t)})),document.querySelector('[data-unit="oz"]'))d="oz";else{if(!document.querySelector('[data-unit="g"]'))return;d="g"}const m=document.createElement("fieldset");document.getElementById("recipe-header").appendChild(m);["oz","g"].forEach((e=>{const t=document.createElement("button");t.setAttribute("data-units",e),e===d&&t.setAttribute("disabled",!0),t.setAttribute("class","button--secondary"),t.setAttribute("type","button"),t.innerText=e,t.addEventListener("click",(e=>{u(e.target,"data-units"),s({units:e.target.getAttribute("data-units")})})),m.appendChild(t)}))}function Modal(e){(()=>{document.body.classList.add("modal-open");const t=document.createElement("dialog");t.setAttribute("class","modal"),t.setAttribute("tabindex","-1");const n=document.createElement("div");n.setAttribute("class","modal__box"),t.appendChild(n);const a=document.createElement("p");a.innerText=e.message,n.appendChild(a);const o=document.createElement("p");o.setAttribute("class","modal__options"),n.appendChild(o),e.buttons.forEach((e=>{const n=document.createElement("button");n.setAttribute("class",`button ${e.class}`.trim()),n.setAttribute("type","button"),n.innerText=e.label,n.addEventListener("click",(()=>{Object.prototype.hasOwnProperty.call(e,"onClick")&&e.onClick(),t.close()})),o.appendChild(n)})),t.addEventListener("click",(e=>{"DIALOG"===e.target.tagName&&t.close()})),document.body.appendChild(t),t.showModal(),t.focus()})()}function Passwordable(e){const t=t=>{const n=t.target.closest(".password-container").querySelector(".password-input");"password"===n.getAttribute("type")?(n.setAttribute("type","text"),n.setAttribute("aria-label","Hide Password"),e.innerText="Hide"):(n.setAttribute("type","password"),n.setAttribute("aria-label","Show Password"),e.innerText="Show")};e.addEventListener("click",t)}function initPasswordable(){document.querySelectorAll("[data-toggle-password]").forEach((e=>{Passwordable(e)}))}function Slugable(e){const t=e.getAttribute("data-slug"),n=document.getElementById(t),a=t=>{var n;e.value=(n=t.target.value)?n.toLowerCase().replace(/ & /g,"-and-").replace(/<[^>]+>/g,"").replace(/['’.]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/--+/g,"-"):""};n.addEventListener("keyup",a)}function initSlugable(){document.querySelectorAll("[data-slug]").forEach((e=>{Slugable(e)}))}initAjax(),initBeforeUnload(),initConfirmable(),initFilterable(),initMeasurement(),initPasswordable(),window.addEventListener("beforeprint",(()=>{document.querySelectorAll("details").forEach((e=>{null!==e.getAttribute("open")&&e.setAttribute("data-reopen","1"),e.setAttribute("open","open")}))})),window.addEventListener("afterprint",(()=>{document.querySelectorAll("details").forEach((e=>{e.getAttribute("data-reopen")?(e.setAttribute("open","open"),e.removeAttribute("data-reopen")):e.removeAttribute("open")}))})),initSlugable();class Spinner{static show(){let e=document.querySelector(".spinner");return e||(e=document.createElement("div"),e.setAttribute("class","spinner"),e.setAttribute("role","alert"),e.innerText="Loading...",document.body.appendChild(e)),e.style.display="",e}static hide(e){e.style.display="none"}}function initSticky(){const e=document.querySelector("[data-sticky]");if(!e)return;const t=()=>{e.setAttribute("data-sticky-offset-top",e.offsetTop),e.style.right=window.innerWidth-e.offsetLeft-e.scrollWidth+"px"};window.addEventListener("scroll",(()=>{const t=window.pageYOffset,n=parseInt(e.getAttribute("data-sticky-offset-top"),10)-parseInt(e.getAttribute("data-sticky-top"),10);e.style.position=t>n?"fixed":""})),window.addEventListener("resize",t),t()}function Timer(e){const t=e=>{const t=new Date(0);let n;return t.setSeconds(e/1e3),n=e<6e5?15:e<36e5?14:e<36e6?12:11,t.toISOString().substring(n).replace(/\.\d+Z$/,"")},n=e=>{const n=e-(new Date).getTime();return n<=0?"":t(n)},a=e=>{e.target.parentNode.remove()},o=()=>{const e=document.querySelectorAll(".timer--on");if(e.length<=0)return clearInterval(window.TICK_INTERVAL),window.TICK_INTERVAL=null,window.DRAG_ELEMENT=null,window.DRAG_START_X=0,window.DRAG_START_Y=0,document.removeEventListener("mousemove",s),document.removeEventListener("keydown",i),document.removeEventListener("touchstart",c,!0),document.removeEventListener("touchend",c,!0),document.removeEventListener("touchcancel",c,!0),void document.removeEventListener("touchmove",d,{passive:!1});e.forEach((e=>{const o=e.getAttribute("data-since");if(o){const n=(e=>{const n=(new Date).getTime()-e;return n<=0?"":t(n)})(Date.parse(o));return void(e.querySelector(".timer__text").innerText=n)}const i=n(Date.parse(e.getAttribute("data-until")));if(""===i){e.classList.remove("timer--on");const t=e.querySelector(".timer__text");return t.removeEventListener("mousedown",r),t.removeEventListener("mouseup",l),t.addEventListener("click",a),t.innerText="Stop",void e.querySelector("audio").play()}e.querySelector(".timer__text").innerText=i}))},i=e=>{"Escape"===e.key&&(window.DRAG_ELEMENT=null)},r=e=>{window.DRAG_ELEMENT=e.target.closest(".timer");const t=parseFloat(window.DRAG_ELEMENT.style.left)||window.DRAG_ELEMENT.offsetLeft,n=parseFloat(window.DRAG_ELEMENT.style.top)||window.DRAG_ELEMENT.offsetTop,a=e.clientX?e.clientX:e.x,o=e.clientY?e.clientY:e.y;return window.DRAG_START_X=t?a-t:a,window.DRAG_START_Y=n?o-n:o,e.preventDefault(),!1},l=()=>{window.DRAG_ELEMENT=null},s=e=>{if(null===window.DRAG_ELEMENT)return;const t=window.DRAG_ELEMENT.querySelector(".timer__text");let n=e.clientX-window.DRAG_START_X;n=Math.max(0,n),n=Math.min(n,window.innerWidth-t.clientWidth);let a=e.clientY-window.DRAG_START_Y;a=Math.max(0,a),a=Math.min(a,window.innerHeight-t.clientHeight),window.DRAG_ELEMENT.style.left=`${n}px`,window.DRAG_ELEMENT.style.top=`${a}px`,window.DRAG_ELEMENT.style.bottom="auto",window.DRAG_ELEMENT.style.right="auto"},u=e=>{const t=e.changedTouches[0],n=document.createEvent("MouseEvent");return n.initMouseEvent({touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[e.type],!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),n},c=e=>{if("timer__text"!==e.target.className)return;e.changedTouches[0].target.dispatchEvent(u(e)),e.preventDefault()},d=e=>{null!==window.DRAG_ELEMENT&&(s(u(e)),e.preventDefault())},m=()=>{const t=new Date,u=parseInt(e.getAttribute("data-timer"),10),m=0===u;t.setSeconds(t.getSeconds()+u);const p=document.getElementById("timer-container"),b=document.createElement("div");b.setAttribute("class","timer timer--on"),m?b.setAttribute("data-since",t):b.setAttribute("data-until",t),p.appendChild(b);const f=document.createElement("button");if(f.setAttribute("class","timer__text"),f.setAttribute("type","button"),f.innerText=m?"0:00":n(t),f.addEventListener("mousedown",r),f.addEventListener("mouseup",l),b.appendChild(f),!m){const e=document.createElement("audio");e.setAttribute("loop",!0),b.appendChild(e);const t=document.createElement("source");t.setAttribute("src","/assets/sounds/magnolia-simms.mp3"),t.setAttribute("type","audio/mpeg"),e.appendChild(t)}const E=document.createElement("button");E.setAttribute("aria-label","Stop"),E.setAttribute("class","timer__stop"),E.setAttribute("type","button"),E.innerText="×",E.addEventListener("click",a),b.appendChild(E),window.TICK_INTERVAL||(window.TICK_INTERVAL=setInterval(o,500),window.DRAG_ELEMENT=null,window.DRAG_START_X=0,window.DRAG_START_Y=0,document.addEventListener("mousemove",s),document.addEventListener("keydown",i),document.addEventListener("touchstart",c,!0),document.addEventListener("touchend",c,!0),document.addEventListener("touchcancel",c,!0),document.addEventListener("touchmove",d,{passive:!1}))};e.addEventListener("click",m)}function initTimer(){const e=document.querySelectorAll("[data-timer]");if(e.length<=0)return;e.forEach((e=>{Timer(e)}));const t=document.createElement("div");t.setAttribute("id","timer-container"),document.body.appendChild(t)}initSticky(),initTimer();class Toast{static show(e,t={}){t.class=t.class||"",t.closeButtonClass=t.closeButtonText||"",t.closeButtonText=t.closeButtonText||"Close",t.duration=t.duration||3e3;let n=document.getElementById("toast-container");n||(n=document.createElement("div"),n.setAttribute("id","toast-container"),document.body.append(n));const a=`toast-${(new Date).getTime()}`,o=document.createElement("div");o.setAttribute("class",`toast ${t.class}`.trim()),o.setAttribute("id",a),o.setAttribute("role","alert"),o.style.animationDuration=`${t.duration}ms`,n.appendChild(o);const i=document.createElement("p");if(i.setAttribute("class","toast-text"),i.innerText=e,o.appendChild(i),!t.hideClose){const e=e=>{Toast.hide(e)},n=document.createElement("button");n.setAttribute("class",`toast-close ${t.closeButtonClass}`.trim()),n.setAttribute("type","button"),t.closeButtonAttributes&&Object.keys(t.closeButtonAttributes).forEach((e=>{n.setAttribute(e,t.closeButtonAttributes[e])})),n.innerText=t.closeButtonText,n.addEventListener("click",e),o.appendChild(n)}return setTimeout((()=>{o.remove()}),t.duration+1e3),o}static hide(e){e.target.closest(".toast").remove()}}function Toggleable(e){const t=()=>{const t=e.getAttribute("data-toggleable");document.querySelector(t).classList.toggle("show");const n=e.getAttribute("data-toggleable-body-class");n&&document.body.classList.toggle(n)};e.addEventListener("click",t)}function initToggleable(){document.querySelectorAll("[data-toggleable]").forEach((e=>{Toggleable(e)}))}initToggleable();