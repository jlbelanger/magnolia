!function(){"use strict";class t{static show(){let t=document.querySelector(".spinner");return t||(t=document.createElement("div"),t.setAttribute("class","spinner"),t.setAttribute("role","status"),t.innerText="Loading...",document.body.appendChild(t)),t.classList.remove("hide"),t}static hide(t){t.classList.add("hide")}}class e{static show(t,a={}){a.class=a.class||"",a.closeButtonClass=a.closeButtonClass||"",a.closeButtonText=a.closeButtonText||"Close",a.duration=a.duration||5e3;let n=document.getElementById("toast-container");n||(n=document.createElement("div"),n.setAttribute("id","toast-container"),document.body.append(n));const s=`toast-${(new Date).getTime()}`,o=document.createElement("div");o.setAttribute("aria-live","polite"),o.setAttribute("class",`toast ${a.class}`.trim()),o.setAttribute("id",s),o.setAttribute("role","alert"),o.style.animationDuration=`${a.duration}ms`,n.appendChild(o);const c=document.createElement("p");if(c.setAttribute("class","toast-text"),c.innerText=t,o.appendChild(c),!a.hideClose){const t=t=>{e.hide(t)},n=document.createElement("button");n.setAttribute("aria-label",a.closeButtonText),n.setAttribute("class",`toast-close ${a.closeButtonClass}`.trim()),n.setAttribute("type","button"),a.closeButtonAttributes&&Object.keys(a.closeButtonAttributes).forEach(t=>{n.setAttribute(t,a.closeButtonAttributes[t])}),n.addEventListener("click",t),o.appendChild(n)}return setTimeout(()=>{o.remove()},a.duration+1e3),o}static hide(t){t.target.closest(".toast").remove()}}function a(a){a.preventDefault();const n=a.target,s=new FormData(n),o={method:n.getAttribute("method"),body:s,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}},c=t.show();fetch(n.getAttribute("action"),o).then(a=>{if(t.hide(c),200!==a.status)throw a;e.show("Saved successfully.",{class:"toast--success"})}).catch(a=>{t.hide(c),e.show(`Save failed. (${a.status} ${a.statusText})`,{class:"toast--danger"})})}function n(t){return t.preventDefault(),"You have unsaved changes. Are you sure you want to leave the page?"}function s(){window.HAS_UNSAVED_CHANGES||(window.HAS_UNSAVED_CHANGES=!0,window.addEventListener("beforeunload",n,{capture:!0}),document.title=`* ${document.title}`)}const o=()=>{window.HAS_UNSAVED_CHANGES=!1,window.removeEventListener("beforeunload",n,{capture:!0}),document.title=document.title.replace(/^\* /,"")};class c{constructor(t){this.args=t}show(){document.body.classList.add("modal-open");const t=document.createElement("dialog");t.setAttribute("class","modal"),t.setAttribute("tabindex","-1");const e=document.createElement("div");e.setAttribute("class","modal__box"),t.appendChild(e);const a=document.createElement("p");a.innerText=this.args.message,e.appendChild(a);const n=document.createElement("p");n.setAttribute("class","modal__options"),e.appendChild(n),this.args.buttons.forEach(e=>{const a=document.createElement("button");a.setAttribute("class",`button ${e.class}`.trim()),a.setAttribute("type","button"),a.innerText=e.label,a.addEventListener("click",()=>{Object.hasOwn(e,"onClick")&&e.onClick(),t.close()}),n.appendChild(a)}),t.addEventListener("click",e=>{"DIALOG"===e.target.tagName&&t.close()}),document.body.appendChild(t),t.showModal(),t.focus()}}function r(t){const e=t.target,a=e.getAttribute("data-confirmable");new c({message:a,buttons:[{label:"Cancel",class:"button--secondary"},{label:e.innerText,class:e.getAttribute("class"),onClick:()=>{const t=e.closest("form");void 0!==t.getAttribute("data-ignore-unsaved")&&o(),t.submit()}}]}).show()}function i(t){const e=t.target.getAttribute("id");var a;document.querySelector(`[data-slug="${e}"]`).value=(a=t.target.value)?a.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/ & /g,"-and-").replace(/<[^>]+>/g,"").replace(/['â€™.]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/--+/g,"-"):""}function l(t){const e=t.target,a=e.getAttribute("data-toggleable"),n=document.querySelectorAll(a),s=e.getAttribute("data-toggleable-body-class");s&&document.body.classList.toggle(s),Array.from(n).forEach(t=>{let a;a=t.classList.contains("show")?function(t,e){const a=t.getAttribute("aria-controls");return t.setAttribute("aria-expanded","false"),e.classList.remove("show"),document.body.classList.remove(`show-${a}`),t.getAttribute("data-toggleable-show")}(e,t):function(t,e){const a=t.getAttribute("aria-controls");return t.setAttribute("aria-expanded","true"),e.classList.add("show"),document.body.classList.add(`show-${a}`),t.getAttribute("data-toggleable-hide")}(e,t),a&&e.setAttribute("title",a)})}document.querySelectorAll("[data-ajax]").forEach(t=>{t.addEventListener("submit",a)}),(()=>{const t=document.querySelector("[data-form]");if(t){t.querySelectorAll("input,select,textarea").forEach(t=>{t.addEventListener("keyup",s),t.addEventListener("change",s)}),t.addEventListener("submit",o)}})(),document.querySelectorAll("[data-confirmable]").forEach(t=>{t.addEventListener("click",r,!0)}),document.querySelectorAll("[data-slug]").forEach(t=>{const e=t.getAttribute("data-slug");document.getElementById(e).addEventListener("keyup",i)}),(()=>{const t=document.querySelector('[data-action="add-time"]');if(!t)return;const e=document.querySelector("table"),a=document.querySelector("tbody"),n=document.querySelector("tfoot"),s=(t,e,a="text")=>{const n=document.createElement("td"),s=document.createElement("input");return s.setAttribute("aria-labelledby",`header-${t}`),s.setAttribute("name",`new_times[${e}][${t}]`),"checkbox"===a?s.setAttribute("value","1"):s.setAttribute("required","required"),s.setAttribute("type",a),n.appendChild(s),n},o=t=>{t.target.closest("tr").remove(),a.children.length<=0&&n.children.length<=0&&e.classList.add("hide")},c=()=>{const t=a.children.length+n.children.length,c=document.createElement("tr"),r=s("order_num",t);c.appendChild(r),r.querySelector("input").value=t+1;const i=s("minutes",t);c.appendChild(i),c.appendChild(s("title",t)),c.appendChild(s("is_active",t,"checkbox"));const l=document.createElement("td"),d=document.createElement("button");d.innerText="Remove",d.addEventListener("click",o),d.setAttribute("class","button--danger"),d.setAttribute("type","button"),l.appendChild(d),c.appendChild(l),n.appendChild(c),e.classList.remove("hide"),i.querySelector("input").focus()};(()=>{t.addEventListener("click",c);document.querySelectorAll('[data-action="remove-time"]').forEach(t=>{t.addEventListener("click",o)})})()})(),document.querySelectorAll("[data-toggleable]").forEach(t=>{t.addEventListener("click",l)})}();